!function(r,e){var l=document,u={init:function(){var n=l.querySelector("#content ul");this.getAjaxModule(function(e){e({url:"/",data:{act:"getScreenMsg"},method:"get",error:function(e){console.log(e)},success:function(e){if(e=JSON.parse(e),console.log(e),"success"==e.status){var t=e.data;0<t.length&&(u.renderData(t,n),u.openAdd(),u.delMsg(t))}else alert("err:"+e.msg)}})})},renderData:function(e,t){for(var n=l.createDocumentFragment(),o=0,i=e.length;o<i;o++){var s=l.createElement("li");s.innerHTML='<div class="msg">'+e[o].msg+'</div><div class="time">'+e[o].msgTime+'<i class="iconfont icon-lajixiang"></i></div>',n.appendChild(s)}t.appendChild(n)},openAdd:function(){var e=l.querySelector("#addMsg .top"),t=l.querySelector("#addMsg .top i"),n=l.querySelector("#addMsg .bottom"),o=l.querySelector("#addMsg .bottom textarea"),i=l.querySelector("#addMsg .bottom input"),s=l.querySelector("#content ul"),a=0;e.onclick=function(){a++,n.style.height=a%2==1?"135px":"0"},t.onclick=function(){n.style.height="0"},i.onclick=function(){""!=o.value&&u.getAjaxModule(function(e){e({url:"/",data:{act:"addScreenMsg",msg:o.value,adminAcount:r.sessionStorage.getItem("adminUser")},method:"post",error:function(e){console.log(e)},success:function(e){if(e=JSON.parse(e),console.log(e),"success"==e.status){u.openHintInfo("添加成功");var t=l.createElement("li");t.innerHTML='<div class="msg">'+o.value+'</div><div class="time">'+u.getNowTime()+'<i class="iconfont icon-lajixiang"></i></div>',s.appendChild(t),o.value=""}else alert(e.msg)}})})}},delMsg:function(n,e,t){for(var o=l.getElementsByClassName("icon-lajixiang"),i=l.querySelector("#content ul"),s=i.getElementsByTagName("li"),a=0,c=o.length;a<c;a++)!function(t){o[t].onclick=function(){confirm("确认删除吗")&&u.getAjaxModule(function(e){e({url:"/",data:{act:"delScreenMsg",msgId:n[t].msgId,adminAcount:r.sessionStorage.getItem("adminUser")},method:"get",error:function(e){alert("err:"+e)},success:function(e){e=JSON.parse(e),console.log(e),"success"==e.status?(u.openHintInfo("删除成功"),i.removeChild(s[t])):alert(e.msg)}})})}}(a)},getAjaxModule:function(t){seajs.use("ajax.js",function(e){t&&t(e)})},openHintInfo:function(e){var t=l.getElementById("hintInfo");t.innerHTML=e,t.style.opacity=1;var n=setTimeout(function(){t.style.opacity=0,clearTimeout(n)},1500)},getNowTime:function(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+" "+e.getHours()+"-"+e.getMinutes()+"-"+e.getSeconds()}};u.init()}(window);