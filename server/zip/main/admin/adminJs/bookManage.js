!function(e,o){var i=document,r={init:function(){var n=i.querySelector("#content .bookInfo");this.getAjaxModule(function(o){o({url:"/",data:{act:"getBookInfo",adminAcount:e.sessionStorage.getItem("adminUser")},method:"get",error:function(o){console.log("err:"+o)},success:function(o){if(o=JSON.parse(o),console.log(o),"success"==o.status){var e=o.data;0==o.data.length?alert("没有对应的数据"):(r.readerData(e,n),r.openBookDetail()),r.delBook()}else alert(o.msg)}})})},openSearch:function(){var o=i.getElementById("search"),e=i.getElementById("search-box"),n=i.querySelector("#search-box .close"),l=i.getElementsByName("search-check")[0],t=i.getElementsByName("search-content")[0];oSearchBookInfoUl=i.querySelector("#search-box .bookInfo"),o.onclick=function(){e.style.display="block"},n.onclick=function(){e.style.display="none"},t.onchange=function(){var o=oSearchBookInfoUl.querySelectorAll("#search-box .bookInfo>li");if(1<o.length)for(var e=1,n=o.length;e<n;e++)oSearchBookInfoUl.removeChild(o[e]);r.getAjaxModule(function(o){o({url:"/",data:{act:"searchBookInfo",searchKey:l.value,searchValue:t.value},method:"get",error:function(o){console.log(o)},success:function(o){if(o=JSON.parse(o),console.log(o),"success"==o.status){var e=o.data;0==e.length?r.openHintInfo("没有对应的数据"):(r.readerData(e,oSearchBookInfoUl),r.openBookDetail())}else alert("err:"+o.msg)}})})}},readerData:function(o,e){for(var n=i.createDocumentFragment(),l=0,t=o.length;l<t;l++){var c=i.createElement("li");c.innerHTML="<ul><li>"+o[l].bookId+"</li><li>"+o[l].bookName+"</li><li>"+o[l].bookPublic+"</li><li>"+o[l].bookType+"</li><li>"+o[l].bookPrice+"</li><li>"+o[l].bookTime+"</li><li>"+o[l].shopperName+"</li><li>"+o[l].bookDescribe+'</li><li><i class="iconfont icon-lajixiang"></i></li></ul>',n.appendChild(c)}e.appendChild(n)},openBookDetail:function(){for(var e=i.querySelectorAll(".bookInfo>li:not(:nth-child(1))>ul li:nth-child(8)"),n=i.getElementById("bookDetail"),l=i.querySelector("#bookDetail p"),o=i.querySelector("#bookDetail .close"),t=0,c=e.length;t<c;t++)!function(o){e[o].onclick=function(){n.style.display="block",l.innerHTML=e[o].innerHTML}}(t);o.onclick=function(){n.style.display="none"}},delBook:function(){for(var n=i.querySelector("#content .bookInfo"),l=i.querySelectorAll("#content .bookInfo>li:not(:nth-child(1))"),o=i.querySelectorAll(".bookInfo>li:not(:nth-child(1))>ul li:nth-child(9)"),t=i.querySelectorAll(".bookInfo>li:not(:nth-child(1))>ul li:nth-child(1)"),e=0,c=o.length;e<c;e++)!function(e){o[e].onclick=function(){confirm("确认删除该书籍吗?")&&r.getAjaxModule(function(o){o({url:"/",data:{act:"delShopperBook",bookId:t[e].innerHTML},method:"get",error:function(o){console.log("err:"+o)},success:function(o){o=JSON.parse(o),console.log(o),"success"==o.status?(r.openHintInfo("删除成功"),n.removeChild(l[e])):r.openHintInfo("删除失败")}})})}}(e)},getAjaxModule:function(e){seajs.use("ajax.js",function(o){e&&e(o)})},openHintInfo:function(o){var e=i.getElementById("hintInfo");e.innerHTML=o,console.log(e),e.style.opacity=1;var n=setTimeout(function(){e.style.opacity=0,clearTimeout(n)},1500)}};r.init(),r.openSearch(),r.openBookDetail(),r.delBook()}(window);