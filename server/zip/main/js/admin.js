!function(l,e){var r=document,i=/select|insert|update|delete|exec|script|count|'|"|=|<|>|%/i,c=/(^1[3|4|5|8]\d{9}$)/;function u(){this.init(),this.login(),this.openMenu(),this.checkMenu()}Object.defineProperty(u.prototype,"constructor",{enumerable:!1,value:u}),u.prototype={init:function(){l.sessionStorage.getItem("adminUser")&&(l.sessionStorage.getItem("adminUser"),r.getElementById("loginBox").style.display="none")},login:function(){var e=r.getElementById("login-form"),t={userAcount:r.getElementsByName("acount")[0],userPass:r.getElementsByName("pass")[0]},n=r.getElementsByName("sub")[0],s=r.getElementById("loginOk");e.onsubmit=function(e){(e=e||l.e).preventDefault?e.preventDefault():e.returnValue=!1};var o=[];for(var a in t)!function(e){t[e].onchange=function(){i.test(t[e].value)?(console.log(r.getElementById(e)),r.getElementById(e).innerHTML="不要尝试输入sql等特殊字符，没戏",t[e].style.borderBottomColor="#f00",-1==o.indexOf(e)&&o.push(e)):(r.getElementById(e).innerHTML="",t[e].style.borderBottomColor="#ccc"),"userAcount"==e&&(c.test(t[e].value)?(r.getElementById(e).innerHTML="",t[e].style.borderBottomColor="#ccc"):(r.getElementById(e).innerHTML="格式不对",t[e].style.borderBottomColor="#f00",-1==o.indexOf(e)&&o.push(e)))}}(a);n.onclick=function(){""!=t.userAcount.value&&""!=t.userPass.value&&0==o.length&&u.prototype.getAjaxModule(function(e){e({url:"/",data:{act:"adminLogin",userAcount:t.userAcount.value,userPass:t.userPass.value},method:"post",error:function(e){alert("error:"+e)},success:function(e){e=JSON.parse(e),console.log(e),"success"==e.status?(l.sessionStorage.setItem("adminUser",e.user),console.log(l.sessionStorage.getItem("adminUser")),r.getElementById("loginBox").style.display="none"):"fail"==e.status&&(s.innerHTML=e.msg)}})})}},openMenu:function(){var e=r.getElementById("menu"),t=r.getElementById("content-menu"),n=0;e.onclick=function(){++n%2==1?(t.style.display="block",e.style.color="#900"):(t.style.display="none",e.style.color="#000")}},checkMenu:function(){var e=r.getElementById("content-menu"),o=e.getElementsByTagName("li"),a=r.querySelector("#content-center iframe");r.querySelector("#authNode .close").onclick=function(){r.getElementById("authNode").style.display="none"},e.onclick=function(e){for(var t=(e=e||l.e).target||e.srcElement,n=0,s=o.length;n<s;n++)o[n].classList.remove("menuChange");switch("UL"!=t.nodeName&&t.classList.add("menuChange"),t.id){case"usersDetails":a.src="admin/usersDetails.html";break;case"storesDetails":a.src="admin/storesDetails.html";break;case"visitDetails":a.src="admin/visitDetails.html";break;case"bookManage":a.src="admin/bookManage.html";break;case"bookComment":a.src="admin/bookComment.html";break;case"message":a.src="admin/message.html";break;case"screen-talk":a.src="admin/screenMsg.html";break;case"authority-node":r.getElementById("authNode").style.display="block"}}},getAjaxModule:function(t){seajs.use("ajax.js",function(e){t&&t(e)})},getCookieModule:function(t){seajs.use("cookie.js",function(e){t&&t(e)})}};new u}(window);